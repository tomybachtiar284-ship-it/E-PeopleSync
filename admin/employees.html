<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management - Kompetenza</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        /* Tab Styles */
        .emp-tabs {
            display: flex;
            border-bottom: 2px solid #eee;
            margin-bottom: 20px;
            gap: 5px;
            flex-wrap: wrap;
        }

        .emp-tab {
            padding: 10px 16px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 13px;
            font-weight: 500;
            color: #888;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .emp-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .emp-tab:hover {
            color: var(--primary-color);
        }

        .emp-tab-content {
            display: none;
        }

        .emp-tab-content.active {
            display: block;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #444;
            margin: 18px 0 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #f0f0f0;
        }

        .form-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .form-row .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            font-size: 12px;
            font-weight: 500;
            color: #666;
            margin-bottom: 4px;
            display: block;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            font-size: 13px;
        }

        .photo-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px solid #ddd;
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .emp-modal-body {
            max-height: 65vh;
            overflow-y: auto;
            padding: 0 5px;
        }
    </style>
</head>

<body>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="brand">
                <div class="brand-icon">K</div>
                <span>Kompetenza</span>
            </div>
            <div class="nav-links">
                <div class="nav-label">Main Menu</div>
                <a href="../admin/index.html" class="nav-link"><i class="fas fa-th-large"></i>
                    <span>Dashboard</span></a>
                <a href="employees.html" class="nav-link active"><i class="fas fa-users"></i> <span>Employee
                        Management</span></a>
                <a href="payroll.html" class="nav-link"><i class="fas fa-money-bill-wave"></i> <span>Payroll</span></a>
                <a href="../recruitment/index.html" class="nav-link"><i class="fas fa-user-plus"></i>
                    <span>Recruitment</span></a>
                <a href="../learning/index.html" class="nav-link"><i class="fas fa-graduation-cap"></i> <span>Learning
                        Hub</span></a>
                <a href="../evaluation/index.html" class="nav-link"><i class="fas fa-chart-line"></i>
                    <span>Performance</span></a>
                <div class="nav-label" style="margin-top: 20px;">Settings</div>
                <a href="../admin/settings.html" class="nav-link"><i class="fas fa-cog"></i>
                    <span>Administration</span></a>
                <br>
                <a href="#" onclick="logout()" class="nav-link text-danger"><i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span></a>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-header">
                <div>
                    <h2>Employee Directory</h2>
                    <p class="text-muted">Manage all employees and managers.</p>
                </div>
                <div class="header-right">
                    <div class="user-profile">
                        <div class="user-details">
                            <h4 id="userName">Admin</h4>
                            <span id="userRole">ADMIN HR</span>
                        </div>
                    </div>
                </div>
            </header>

            <div class="content-area">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div class="search-bar" style="width: 300px;">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchEmployee" placeholder="Search name / department..."
                            onkeyup="filterEmployees()">
                    </div>
                    <button class="btn btn-primary" onclick="openCreateEmp()"><i class="fas fa-plus"></i> Add
                        Employee</button>
                </div>
                <div class="card">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>NID</th>
                                <th>Name</th>
                                <th>Department</th>
                                <th>Position</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employeeTableBody"></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Employee Modal -->
    <div id="empModal" class="modal"
        style="display:none; position:fixed; z-index:100; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.5);">
        <div class="modal-content"
            style="background:#fff; margin:3% auto; padding:25px; border-radius:10px; width:85%; max-width:900px;">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h3 id="empModalTitle">Add New Employee</h3>
                <span class="close" onclick="closeEmpModal()" style="font-size:28px; cursor:pointer;">&times;</span>
            </div>

            <!-- Tabs -->
            <div class="emp-tabs">
                <button class="emp-tab active" onclick="showEmpTab('personal')"><i class="fas fa-user"></i>
                    Personal</button>
                <button class="emp-tab" onclick="showEmpTab('employment')"><i class="fas fa-briefcase"></i>
                    Employment</button>
                <button class="emp-tab" onclick="showEmpTab('payedu')"><i class="fas fa-wallet"></i> Pay &
                    Education</button>
                <button class="emp-tab" onclick="showEmpTab('history')"><i class="fas fa-history"></i> History</button>
                <button class="emp-tab" onclick="showEmpTab('documents')"><i class="fas fa-folder-open"></i>
                    Documents</button>
            </div>

            <form id="empForm">
                <input type="hidden" id="empId">
                <div class="emp-modal-body">

                    <!-- TAB 1: Personal Info -->
                    <div id="tab-personal" class="emp-tab-content active">
                        <div class="section-title">Identification</div>
                        <div class="form-row">
                            <div class="form-group" style="flex:0 0 100px;">
                                <label>Photo</label>
                                <div class="photo-preview" id="photoPreview">
                                    <i class="fas fa-camera" style="color:#bbb; font-size:24px;"></i>
                                </div>
                                <input type="file" id="empPhoto" accept="image/*"
                                    style="margin-top:5px; font-size:11px; width:100px;" onchange="previewPhoto(this)">
                            </div>
                            <div class="form-group">
                                <label>NID (Nomor Induk Karyawan)</label>
                                <input type="text" id="empNID" class="form-control" placeholder="EMP-0001">
                            </div>
                            <div class="form-group">
                                <label>Nama Lengkap *</label>
                                <input type="text" id="empName" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Tempat Lahir</label>
                                <input type="text" id="empBirthPlace" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Tanggal Lahir</label>
                                <input type="date" id="empBirthDate" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Jenis Kelamin</label>
                                <select id="empGender" class="form-control">
                                    <option value="">-- Pilih --</option>
                                    <option value="Laki-laki">Laki-laki</option>
                                    <option value="Perempuan">Perempuan</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Status Pernikahan</label>
                                <select id="empMarital" class="form-control">
                                    <option value="">-- Pilih --</option>
                                    <option value="Belum Menikah">Belum Menikah</option>
                                    <option value="Menikah">Menikah</option>
                                    <option value="Cerai">Cerai</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Agama</label>
                                <select id="empReligion" class="form-control">
                                    <option value="">-- Pilih --</option>
                                    <option value="Islam">Islam</option>
                                    <option value="Kristen">Kristen</option>
                                    <option value="Katolik">Katolik</option>
                                    <option value="Hindu">Hindu</option>
                                    <option value="Buddha">Buddha</option>
                                    <option value="Konghucu">Konghucu</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Kewarganegaraan</label>
                                <input type="text" id="empCitizenship" class="form-control" value="Indonesia">
                            </div>
                        </div>

                        <div class="section-title">Identitas & Pajak</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nomor KTP</label>
                                <input type="text" id="empKTP" class="form-control" maxlength="16">
                            </div>
                            <div class="form-group">
                                <label>NPWP</label>
                                <input type="text" id="empNPWP" class="form-control">
                            </div>
                        </div>

                        <div class="section-title">Alamat</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Alamat Domisili</label>
                                <textarea id="empAddressDom" class="form-control" rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Alamat Sesuai KTP</label>
                                <textarea id="empAddressKTP" class="form-control" rows="2"></textarea>
                            </div>
                        </div>

                        <div class="section-title">Kontak</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nomor HP Pribadi</label>
                                <input type="tel" id="empPhone" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>HP Darurat (Emergency)</label>
                                <input type="tel" id="empPhoneEmergency" class="form-control">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email Pribadi</label>
                                <input type="email" id="empEmailPersonal" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Email Perusahaan</label>
                                <input type="email" id="empEmailCompany" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- TAB 2: Employment -->
                    <div id="tab-employment" class="emp-tab-content">
                        <div class="section-title">Status Kepegawaian</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Tanggal Bergabung</label>
                                <input type="date" id="empJoinDate" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Status Karyawan</label>
                                <select id="empStatus" class="form-control">
                                    <option value="Tetap">Tetap</option>
                                    <option value="Kontrak">Kontrak</option>
                                    <option value="Magang">Magang</option>
                                    <option value="Outsource">Outsource</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Masa Kontrak</label>
                                <input type="text" id="empContractPeriod" class="form-control"
                                    placeholder="e.g. 12 bulan">
                            </div>
                        </div>

                        <div class="section-title">Penempatan</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Jabatan</label>
                                <input type="text" id="empPosition" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Departemen / Divisi</label>
                                <select id="empDept" class="form-control">
                                    <!-- JS Populated -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Atasan Langsung</label>
                                <input type="text" id="empSupervisor" class="form-control">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Lokasi Kerja / Site</label>
                                <select id="empLocation" class="form-control">
                                    <!-- JS Populated -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Shift Kerja</label>
                                <select id="empShift" class="form-control">
                                    <option value="">-- Pilih --</option>
                                    <option value="Pagi">Pagi</option>
                                    <option value="Siang">Siang</option>
                                    <option value="Malam">Malam</option>
                                    <option value="Non-Shift">Non-Shift</option>
                                </select>
                            </div>
                        </div>

                        <div class="section-title">Golongan & Level</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Golongan / Grade</label>
                                <input type="text" id="empGrade" class="form-control" placeholder="e.g. III-A">
                            </div>
                            <div class="form-group">
                                <label>Level Jabatan</label>
                                <select id="empLevel" class="form-control">
                                    <option value="Staff">Staff</option>
                                    <option value="Supervisor">Supervisor</option>
                                    <option value="Manager">Manager</option>
                                    <option value="Director">Director</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status Aktif</label>
                                <select id="empActiveStatus" class="form-control">
                                    <option value="Aktif">Aktif</option>
                                    <option value="Resign">Resign</option>
                                    <option value="PHK">PHK</option>
                                    <option value="Pensiun">Pensiun</option>
                                </select>
                            </div>
                        </div>

                        <div class="section-title">BPJS</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>No. BPJS Kesehatan</label>
                                <input type="text" id="empBPJSHealth" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>No. BPJS Ketenagakerjaan</label>
                                <input type="text" id="empBPJSLabor" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- TAB 3: Payroll & Education -->
                    <div id="tab-payedu" class="emp-tab-content">
                        <div class="section-title">Data Penggajian (Payroll)</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Gaji Pokok (Base Salary)</label>
                                <input type="number" id="empBaseSalary" class="form-control" placeholder="Rp 0">
                            </div>
                            <div class="form-group">
                                <label>Tunjangan Tetap (Fixed Allowance)</label>
                                <input type="number" id="empFixedAllowance" class="form-control" placeholder="Rp 0">
                            </div>
                            <div class="form-group">
                                <label>Tunjangan Transport</label>
                                <input type="number" id="empTransportAllowance" class="form-control" placeholder="Rp 0">
                            </div>
                        </div>
                        <div class="section-title">Data Rekening</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nama Bank</label>
                                <input type="text" id="empBankName" class="form-control"
                                    placeholder="e.g. BCA, Mandiri">
                            </div>
                            <div class="form-group">
                                <label>Nomor Rekening</label>
                                <input type="text" id="empBankAccount" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Pemilik Rekening</label>
                                <input type="text" id="empBankHolder" class="form-control">
                            </div>
                        </div>

                        <div class="section-title">Pendidikan</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Pendidikan Terakhir</label>
                                <select id="empEducation" class="form-control">
                                    <option value="">-- Pilih --</option>
                                    <option value="SMA/SMK">SMA/SMK</option>
                                    <option value="D3">D3</option>
                                    <option value="S1">S1</option>
                                    <option value="S2">S2</option>
                                    <option value="S3">S3</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Jurusan</label>
                                <input type="text" id="empMajor" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Tahun Lulus</label>
                                <input type="number" id="empGradYear" class="form-control" min="1970" max="2030">
                            </div>
                        </div>

                        <div class="section-title">Keahlian & Kompetensi</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Keahlian / Skill</label>
                                <input type="text" id="empSkills" class="form-control"
                                    placeholder="e.g. JavaScript, Excel, Public Speaking">
                            </div>
                            <div class="form-group">
                                <label>Sertifikasi Profesional</label>
                                <input type="text" id="empCertifications" class="form-control"
                                    placeholder="e.g. PMP, AWS, BNSP">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Riwayat Pelatihan</label>
                                <textarea id="empTrainingHistory" class="form-control" rows="2"
                                    placeholder="Daftar pelatihan yang pernah diikuti"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Level Kompetensi</label>
                                <select id="empCompetencyLevel" class="form-control">
                                    <option value="Foundation">Foundation</option>
                                    <option value="Practitioner">Practitioner</option>
                                    <option value="Specialist">Specialist</option>
                                    <option value="Mastery">Mastery</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- TAB 4: History & Performance -->
                    <div id="tab-history" class="emp-tab-content">
                        <div class="section-title">Riwayat Karir Internal</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Riwayat Jabatan Internal</label>
                                <textarea id="empPositionHistory" class="form-control" rows="2"
                                    placeholder="e.g. 2020: Staff IT â†’ 2022: Lead IT"></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Riwayat Promosi</label>
                                <textarea id="empPromotionHistory" class="form-control" rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Riwayat Mutasi</label>
                                <textarea id="empMutationHistory" class="form-control" rows="2"></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Riwayat Perusahaan Sebelumnya</label>
                                <textarea id="empPreviousCompany" class="form-control" rows="2"
                                    placeholder="Nama perusahaan, jabatan, tahun"></textarea>
                            </div>
                        </div>

                        <div class="section-title">Performance & Disiplin</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nilai KPI Terakhir</label>
                                <input type="number" id="empKPI" class="form-control" step="0.1" min="0" max="5"
                                    placeholder="e.g. 4.2">
                            </div>
                            <div class="form-group">
                                <label>Riwayat Evaluasi</label>
                                <textarea id="empEvalHistory" class="form-control" rows="2"></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Status Disiplin</label>
                                <input type="text" id="empDiscipline" class="form-control"
                                    placeholder="e.g. SP-1, Baik">
                            </div>
                            <div class="form-group">
                                <label>Catatan HR</label>
                                <textarea id="empHRNotes" class="form-control" rows="2"
                                    placeholder="Catatan internal HR..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- TAB 5: Documents -->
                    <div id="tab-documents" class="emp-tab-content">
                        <div class="section-title">Upload Dokumen</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Dokumen Kontrak (PDF)</label>
                                <input type="file" id="empDocContract" class="form-control" accept=".pdf">
                            </div>
                            <div class="form-group">
                                <label>Ijazah Terakhir (PDF)</label>
                                <input type="file" id="empDocDiploma" class="form-control" accept=".pdf">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Dokumen Sertifikasi (PDF)</label>
                                <input type="file" id="empDocCert" class="form-control" accept=".pdf">
                            </div>
                        </div>

                        <div class="section-title" style="margin-top:25px;">Dokumen Tersimpan</div>
                        <div id="savedDocsList" style="font-size:13px; color:#666;">
                            <p><i class="fas fa-info-circle"></i> Dokumen akan tampil setelah disimpan.</p>
                        </div>
                    </div>

                </div>

                <div class="d-flex justify-content-between align-items-center mt-3"
                    style="border-top:1px solid #eee; padding-top:15px;">
                    <small class="text-muted">* Wajib diisi</small>
                    <div>
                        <button type="button" class="btn btn-secondary" onclick="closeEmpModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Employee</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script src="../js/utils.js"></script>
    <script src="../js/admin_employees.js"></script>
</body>

</html>